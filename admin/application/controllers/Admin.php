<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class Admin extends CI_Controller {    public function __construct() {        parent::__construct();        // date_default_timezone_set('America/Lima');         $this->load->library('session');        $this->load->model('MAdmin');     if (isset($_SERVER['HTTP_ORIGIN'])) {            header("Access-Control-Allow-Origin: {$_SERVER['HTTP_ORIGIN']}");            header('Access-Control-Allow-Credentials: true');            header('Access-Control-Max-Age: 86400');        }        if ($_SERVER['REQUEST_METHOD'] == 'OPTIONS') {            if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD']))                header("Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS");            if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']))                header("Access-Control-Allow-Headers: {$_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']}");        }            }    public function index() {        $datos['titulo'] = "Administrador Loqueleo";        $this->load->view('admin', $datos);    }    public function ingreso() {        if ($_SERVER['REQUEST_METHOD'] == 'POST') {            $user = $this->input->post('user');            $pass = $this->input->post('pass');            $consultas = $this->MAdmin->consultar($user, $pass);            $consulta = end($consultas);            if ($consulta != false) {                if ($consulta->pass == $pass) {                    //session_start();                    //  $_SESSION['USER'] = $consulta;                    //echo "<script>location.href ='panel';</script>";                     $data_login = array('USER' => $consulta,                        'type' => 2,                        'login' => TRUE);                    $this->session->set_userdata($data_login);                    $response['status'] = 'ok';                } else {                    $response['status'] = 0;                    $response['error'] = '<div class="alert alert-danger"><strong>ERROR!</strong> La contrase√±a es incorrecta</div>';                }            } else {                $response['error'] = '<div class="alert alert-danger"><strong>ERROR!</strong> El Usuario es incorrecto</div>';            }        } else {            $response['error'] = "Debe entrar atravez del formul";        }        echo json_encode($response);    }}